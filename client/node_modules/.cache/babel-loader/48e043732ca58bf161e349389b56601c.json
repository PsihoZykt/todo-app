{"ast":null,"code":"import _objectSpread from \"/home/psihoz/todo-app-back/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport UsersAPI from '../api/UsersAPI';\nconst SET_USER = 'SET_USER';\nconst initialState = {\n  isAuth: false,\n  currentUser: {}\n};\nexport default ((state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER:\n      {\n        if (state.isAuth === action.isAuth && state.currentUser && state.currentUser.isAuth && state.currentUser.id === action.user.id && state.currentUser.email === action.user.email && state.currentUser.username === action.user.username) {\n          return _objectSpread({}, state);\n        } else {\n          return _objectSpread({}, state, {\n            isAuth: action.isAuth,\n            currentUser: action.user\n          });\n        }\n      }\n\n    default:\n      return state;\n  }\n});\nexport const setUserSession = user => ({\n  type: SET_USER,\n  isAuth: true,\n  user\n});\nexport const deleteUserSession = () => ({\n  type: SET_USER,\n  isAuth: false,\n  user: null\n}); // Thunks\n\nexport const login = (username, email, password) => dispatch => {\n  return UsersAPI.login(username, email, password).then(res => {\n    console.log(res); // if (res.user !== null) {\n\n    dispatch(setUserSession(res.user)); // } else {\n    //   dispatch(deleteUserSession());\n    // }\n\n    return res.user;\n  }).catch(err => err);\n};\nexport const logout = () => dispatch => UsersAPI.logout().then(() => dispatch(deleteUserSession()));\nexport const createUser = (username, email, password) => dispatch => {\n  return UsersAPI.createUser(username, email, password).then(res => {\n    UsersAPI.login(username, email, password).then(res => {\n      if (res.user !== null) {\n        dispatch(setUserSession(res.user));\n      } else {\n        dispatch(deleteUserSession());\n      }\n    });\n  }).catch(err => {\n    console.log(err);\n  });\n};\nexport const checkAuth = () => dispatch => UsersAPI.isAuth().then(res => {\n  if (res.user !== null) {\n    return dispatch(setUserSession(res.user));\n  } else {\n    return dispatch(deleteUserSession());\n  }\n});","map":{"version":3,"sources":["/home/psihoz/todo-app-back/client/src/redux/authReducer.js"],"names":["UsersAPI","SET_USER","initialState","isAuth","currentUser","state","action","type","id","user","email","username","setUserSession","deleteUserSession","login","password","dispatch","then","res","console","log","catch","err","logout","createUser","checkAuth"],"mappings":"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","sourcesContent":["import UsersAPI from '../api/UsersAPI';\n\nconst SET_USER = 'SET_USER';\n\nconst initialState = {\n  isAuth: false,\n  currentUser: {},\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER: {\n      if (state.isAuth === action.isAuth &&\n        state.currentUser && state.currentUser.isAuth &&\n        state.currentUser.id === action.user.id &&\n        state.currentUser.email === action.user.email &&\n        state.currentUser.username === action.user.username\n      ) {\n        return { ...state };\n      } else {\n        return {\n          ...state,\n          isAuth: action.isAuth,\n          currentUser: action.user\n        };\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport const setUserSession = user => ({\n  type: SET_USER,\n  isAuth: true,\n  user,\n});\n\nexport const deleteUserSession = () => ({\n  type: SET_USER,\n  isAuth: false,\n  user: null,\n});\n\n// Thunks\nexport const login = (username, email, password) => dispatch => {\n  return UsersAPI.login(username, email, password)\n    .then((res) => {\n      console.log(res)\n      // if (res.user !== null) {\n        dispatch(setUserSession(res.user));\n      // } else {\n      //   dispatch(deleteUserSession());\n      // }\n      return res.user\n    })\n    .catch((err) =>  err);\n};\nexport const logout = () => dispatch => UsersAPI.logout()\n  .then(() => dispatch(deleteUserSession()));\n\n\nexport const createUser = (username, email, password) => dispatch => {\n  return UsersAPI.createUser(username, email, password)\n    .then(res => {\n      UsersAPI.login(username, email, password)\n        .then((res) => {\n          if (res.user !== null) {\n            dispatch(setUserSession(res.user));\n          } else {\n            dispatch(deleteUserSession());\n          }\n        });\n    })\n    .catch(err => {\n      console.log(err);\n    });\n};\nexport const checkAuth = () => dispatch => UsersAPI.isAuth()\n  .then((res) => {\n    if (res.user !== null) {\n      return dispatch(setUserSession(res.user));\n    } else {\n      return dispatch(deleteUserSession());\n    }\n  });\n"]},"metadata":{},"sourceType":"module"}