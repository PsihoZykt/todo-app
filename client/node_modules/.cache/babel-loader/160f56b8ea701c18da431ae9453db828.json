{"ast":null,"code":"import _objectSpread from \"/home/psihoz/todo-app-back/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport UsersAPI from '../api/UsersAPI';\nconst SET_USER = 'SET_USER';\nconst initialState = {\n  isAuth: false,\n  currentUser: {}\n};\nexport default ((state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER:\n      {\n        if (state.isAuth === action.isAuth && state.currentUser && state.currentUser.isAuth && state.currentUser.id === action.user.id && state.currentUser.email === action.user.email && state.currentUser.username === action.user.username) {\n          return _objectSpread({}, state);\n        } else {\n          return _objectSpread({}, state, {\n            isAuth: action.isAuth,\n            currentUser: action.user\n          });\n        }\n      }\n\n    default:\n      return state;\n  }\n});\nexport const setUserSession = user => ({\n  type: SET_USER,\n  isAuth: true,\n  user\n});\nexport const deleteUserSession = () => ({\n  type: SET_USER,\n  isAuth: false,\n  user: null\n}); // Thunks\n\nexport const login = (username, email, password) => dispatch => UsersAPI.login(username, email, password).then(res => {\n  console.log('LOGIN IS' + res.user);\n\n  if (res.user !== null) {\n    dispatch(setUserSession(res.user));\n  } else {\n    dispatch(deleteUserSession());\n  }\n});\nexport const logout = () => dispatch => UsersAPI.logout().then(() => dispatch(deleteUserSession()));\nexport const createUser = (username, email, password) => dispatch => {\n  return UsersAPI.createUser(username, email, password).then(res => {\n    console.log(res);\n\n    if (res.data.user !== null) {\n      dispatch(setUserSession(res.user));\n    } else {\n      dispatch(deleteUserSession());\n    }\n  }).catch(err => {\n    console.log(err);\n  });\n};\nexport const checkAuth = () => dispatch => UsersAPI.isAuth().then(res => {\n  if (res.user !== null) {\n    return dispatch(setUserSession(res.user));\n  } else {\n    return dispatch(deleteUserSession());\n  }\n});","map":{"version":3,"sources":["/home/psihoz/todo-app-back/client/src/redux/authReducer.js"],"names":["UsersAPI","SET_USER","initialState","isAuth","currentUser","state","action","type","id","user","email","username","setUserSession","deleteUserSession","login","password","dispatch","then","res","console","log","logout","createUser","data","catch","err","checkAuth"],"mappings":"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","sourcesContent":["import UsersAPI from '../api/UsersAPI';\n\nconst SET_USER = 'SET_USER';\n\nconst initialState = {\n  isAuth: false,\n  currentUser: {},\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_USER: {\n      if (state.isAuth === action.isAuth &&\n        state.currentUser && state.currentUser.isAuth &&\n        state.currentUser.id === action.user.id &&\n        state.currentUser.email === action.user.email &&\n        state.currentUser.username === action.user.username\n      ) {\n        return { ...state };\n      } else {\n        return {\n          ...state,\n          isAuth: action.isAuth,\n          currentUser: action.user\n        };\n      }\n    }\n    default:\n      return state;\n  }\n};\n\nexport const setUserSession = user => ({\n  type: SET_USER,\n  isAuth: true,\n  user,\n});\n\nexport const deleteUserSession = () => ({\n  type: SET_USER,\n  isAuth: false,\n  user: null,\n});\n\n// Thunks\nexport const login = (username, email, password) => dispatch => UsersAPI.login(username, email, password)\n  .then((res) => {\n    console.log('LOGIN IS' + res.user);\n    if (res.user !== null) {\n      dispatch(setUserSession(res.user));\n    } else {\n      dispatch(deleteUserSession());\n    }\n  });\n\nexport const logout = () => dispatch => UsersAPI.logout()\n  .then(() => dispatch(deleteUserSession()));\n\n\nexport const createUser = (username, email, password) => dispatch => {\n return UsersAPI.createUser(username, email, password)\n    .then(res => {\n      console.log(res)\n      if (res.data.user !== null) {\n        dispatch(setUserSession(res.user));\n      } else {\n        dispatch(deleteUserSession());\n      }})\n      .catch(err => {\n        console.log(err);\n      });\n    };\n  export const checkAuth = () => dispatch => UsersAPI.isAuth()\n    .then((res) => {\n      if (res.user !== null) {\n        return dispatch(setUserSession(res.user));\n      } else {\n        return dispatch(deleteUserSession());\n      }\n    });\n"]},"metadata":{},"sourceType":"module"}