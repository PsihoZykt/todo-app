{"ast":null,"code":"import _objectSpread from \"/home/psihoz/todo-app-back/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread\";\nimport TodosAPI from '../api/TodosAPI';\nconst ADD_TASK = 'ADD_TASK';\nconst REMOVE_TASK = 'REMOVE_TASK';\nconst SET_TASKS = 'SET_TASKS';\nconst EDIT_TASK = 'EDIT_TASK';\nconst TOGGLE_IS_ACTIVE = 'TOGGLE_IS_ACTIVE';\nconst initialState = {\n  tasks: []\n};\nexport default ((state = initialState, action) => {\n  switch (action.type) {\n    case SET_TASKS:\n      {\n        console.log(\"get tasks \" + action.tasks.length);\n        return _objectSpread({}, state, {\n          tasks: action.tasks\n        });\n      }\n\n    case ADD_TASK:\n      {\n        return _objectSpread({}, state, {\n          tasks: [...state.tasks, action.task]\n        });\n      }\n\n    case EDIT_TASK:\n      {\n        let newTasks = [...state.tasks];\n        newTasks = newTasks.map(task => {\n          let newTask = _objectSpread({}, task);\n\n          if (newTask.id === action.task.id) {\n            newTask = action.task;\n          }\n\n          return newTask;\n        });\n        return _objectSpread({}, state, {\n          tasks: newTasks\n        });\n      }\n\n    case REMOVE_TASK:\n      {\n        const taskIdx = state.tasks.findIndex(task => task.id === action.task.id);\n        const newTasks = [...state.tasks.filter((elem, idx) => idx !== taskIdx)];\n        return _objectSpread({}, state, {\n          tasks: newTasks\n        });\n      }\n\n    case TOGGLE_IS_ACTIVE:\n      {\n        let newTasks = [...state.tasks];\n        newTasks = newTasks.map(task => {\n          let newTask = _objectSpread({}, task);\n\n          if (newTask.id === action.task.id) {\n            newTask = action.task;\n          } else {\n            newTask.isActive = false;\n          }\n\n          return newTask;\n        });\n        return _objectSpread({}, state, {\n          tasks: newTasks\n        });\n      }\n\n    default:\n      return state;\n  }\n});\nexport const addTask = task => ({\n  type: ADD_TASK,\n  task\n});\nexport const removeTask = task => ({\n  type: REMOVE_TASK,\n  task\n});\nexport const toggleIsActive = task => ({\n  type: TOGGLE_IS_ACTIVE,\n  task\n});\nexport const setTasks = tasks => ({\n  type: SET_TASKS,\n  tasks\n});\nexport const editTask = task => ({\n  type: EDIT_TASK,\n  task\n}); // Thunks\n\nexport const postTask = task => dispatch => {\n  TodosAPI.postTodo(task).then(todo => {\n    const newTask = {\n      id: todo.id,\n      name: todo.name,\n      isActive: todo.isActive,\n      subTasks: todo.subTasks\n    };\n    return dispatch(addTask(newTask));\n  }).catch(err => console.log(err));\n};\nexport const getTasks = () => dispatch => {\n  TodosAPI.getAllTodos().then(data => dispatch(setTasks(data))).catch(err => console.log(err));\n};\nexport const deleteTask = task => dispatch => {\n  TodosAPI.deleteTodo(task).then(() => dispatch(removeTask(task))).catch(err => console.log(err));\n};\nexport const toggleTaskActive = task => dispatch => {\n  const newTask = _objectSpread({}, task);\n\n  newTask.isActive = !task.isActive;\n  dispatch(toggleIsActive(newTask)); // // Update all todos, because I need to update isACtive in other todos\n  // TodosAPI.editTask(newTask)\n  //   .then(() => TodosAPI.getAllTodos().then(data => {\n  //     return dispatch(setTasks(data));\n  //   }),\n  //   )\n  //   .catch(err => console.log(err));\n};\nexport const addSubtask = (task, label) => dispatch => {\n  const newTask = _objectSpread({}, task);\n\n  newTask.subTasks = [...task.subTasks];\n  newTask.subTasks.push({\n    label,\n    isChecked: false\n  });\n  return TodosAPI.editTask(newTask).then(data => {\n    return dispatch(editTask(data));\n  });\n};\nexport const toggleSubTaskChecked = (task, id, isChecked) => dispatch => {\n  const newTask = _objectSpread({}, task);\n\n  newTask.subTasks = newTask.subTasks.map(subTask => {\n    const newSubTask = _objectSpread({}, subTask);\n\n    if (newSubTask.id === id) newSubTask.isChecked = isChecked;\n    return newSubTask;\n  });\n  return TodosAPI.editTask(newTask).then(data => dispatch(editTask(data)));\n};\nexport const removeSubtask = (task, id) => dispatch => {\n  const newTask = _objectSpread({}, task);\n\n  newTask.subTasks = newTask.subTasks.filter(subTask => subTask.id !== id);\n  return TodosAPI.editTask(newTask).then(data => {\n    return dispatch(editTask(data));\n  });\n};","map":{"version":3,"sources":["/home/psihoz/todo-app-back/client/src/redux/navReducer.js"],"names":["TodosAPI","ADD_TASK","REMOVE_TASK","SET_TASKS","EDIT_TASK","TOGGLE_IS_ACTIVE","initialState","tasks","state","action","type","console","log","length","task","newTasks","map","newTask","id","taskIdx","findIndex","filter","elem","idx","isActive","addTask","removeTask","toggleIsActive","setTasks","editTask","postTask","dispatch","postTodo","then","todo","name","subTasks","catch","err","getTasks","getAllTodos","data","deleteTask","deleteTodo","toggleTaskActive","addSubtask","label","push","isChecked","toggleSubTaskChecked","subTask","newSubTask","removeSubtask"],"mappings":"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","sourcesContent":["import TodosAPI from '../api/TodosAPI';\n\nconst ADD_TASK = 'ADD_TASK';\nconst REMOVE_TASK = 'REMOVE_TASK';\nconst SET_TASKS = 'SET_TASKS';\nconst EDIT_TASK = 'EDIT_TASK';\nconst TOGGLE_IS_ACTIVE = 'TOGGLE_IS_ACTIVE';\nconst initialState = {\n  tasks: [],\n};\n\nexport default (state = initialState, action) => {\n  switch (action.type) {\n    case SET_TASKS: {\n      console.log(\"get tasks \" + action.tasks.length)\n      return {\n        ...state,\n        tasks: action.tasks\n      };\n    }\n    case ADD_TASK: {\n      return {\n        ...state,\n        tasks: [...state.tasks, action.task],\n      };\n    }\n    case EDIT_TASK: {\n      let newTasks = [...state.tasks];\n      newTasks = newTasks.map(task => {\n        let newTask = { ...task };\n        if (newTask.id === action.task.id) {\n          newTask = action.task;\n        }\n        return newTask;\n      });\n      return {\n        ...state,\n        tasks: newTasks\n      };\n    }\n    case REMOVE_TASK: {\n      const taskIdx = state.tasks.findIndex(task => task.id === action.task.id);\n      const newTasks = [...state.tasks.filter((elem, idx) => idx !== taskIdx)];\n      return {\n        ...state,\n        tasks: newTasks\n      };\n    }\n    case TOGGLE_IS_ACTIVE: {\n      let newTasks = [...state.tasks];\n      newTasks = newTasks.map(task => {\n        let newTask = { ...task };\n        if (newTask.id === action.task.id) {\n          newTask = action.task;\n        } else {\n          newTask.isActive = false;\n        }\n        return newTask;\n      });\n      return {\n        ...state,\n        tasks: newTasks\n      };\n    }\n\n    default:\n      return state;\n  }\n};\n\nexport const addTask = task => ({\n  type: ADD_TASK,\n  task,\n});\n\nexport const removeTask = task => ({\n  type: REMOVE_TASK,\n  task,\n});\nexport const toggleIsActive = task => ({\n  type: TOGGLE_IS_ACTIVE,\n  task,\n});\nexport const setTasks = tasks => ({\n  type: SET_TASKS,\n  tasks,\n});\n\nexport const editTask = task => ({\n  type: EDIT_TASK,\n  task,\n});\n\n// Thunks\nexport const postTask = task => dispatch => {\n  TodosAPI.postTodo(task)\n    .then(todo => {\n      const newTask = {\n        id: todo.id,\n        name: todo.name,\n        isActive: todo.isActive,\n        subTasks: todo.subTasks,\n      };\n      return dispatch(addTask(newTask));\n    })\n    .catch(err => console.log(err));\n};\nexport const getTasks = () => dispatch => {\n  TodosAPI.getAllTodos()\n    .then(data => dispatch(setTasks(data)))\n    .catch(err => console.log(err));\n};\nexport const deleteTask = task => dispatch => {\n  TodosAPI.deleteTodo(task)\n    .then(() => dispatch(removeTask(task)))\n    .catch(err => console.log(err));\n};\n\nexport const toggleTaskActive = task => dispatch => {\n  const newTask = { ...task };\n  newTask.isActive = !task.isActive;\n  dispatch(toggleIsActive(newTask))\n  // // Update all todos, because I need to update isACtive in other todos\n  // TodosAPI.editTask(newTask)\n  //   .then(() => TodosAPI.getAllTodos().then(data => {\n  //     return dispatch(setTasks(data));\n  //   }),\n  //   )\n  //   .catch(err => console.log(err));\n};\n\nexport const addSubtask = (task, label) => dispatch => {\n  const newTask = { ...task };\n  newTask.subTasks = [...task.subTasks];\n  newTask.subTasks.push({\n    label,\n    isChecked: false\n  });\n  return TodosAPI.editTask(newTask)\n    .then(data => {\n      return dispatch(editTask(data));\n    });\n};\n\nexport const toggleSubTaskChecked = (task, id, isChecked) => dispatch => {\n  const newTask = { ...task };\n  newTask.subTasks = newTask.subTasks.map(subTask => {\n    const newSubTask = { ...subTask };\n    if (newSubTask.id === id) newSubTask.isChecked = isChecked;\n    return newSubTask;\n  });\n  return TodosAPI.editTask(newTask)\n    .then(data => dispatch(editTask(data)));\n};\n\nexport const removeSubtask = (task, id) => dispatch => {\n  const newTask = { ...task };\n  newTask.subTasks = newTask.subTasks.filter(subTask => subTask.id !== id);\n  return TodosAPI.editTask(newTask)\n    .then(data => {\n      return dispatch(editTask(data));\n    });\n};\n\n"]},"metadata":{},"sourceType":"module"}